#!/bin/bash

export WINEPREFIX="${HOME}/Games/star_citizen/"
export WINEARCH='win64'
export WINEDEBUG='-all'

export INSTALLER_BIN='RSI-Setup-1.1.0.exe'
export INSTALLER_URL="https://install.robertsspaceindustries.com/star-citizen/${INSTALLER_BIN}"

DXVK_VERSION='0.96'
DXVK_DIR="dxvk-${DXVK_VERSION}"
DXVK_TAR="${DXVK_DIR}.tar.gz"
DXVK_URL="https://github.com/doitsujin/dxvk/releases/download/v${DXVK_VERSION}/${DXVK_TAR}"

if [ $# -ne 0 ]
then
  if [ "${1}" == "install" ]
  then
    mkdir -p $WINEPREFIX
    cd $WINEPREFIX
    winecfg
    wget $INSTALLER_URL
    wget $DXVK_URL
    tar xzvf $DXVK_TAR
    cd $DXVK_DIR
    winetricks --force setup_dxvk.verb
    cd $WINEPREFIX
    winetricks corefonts
    wine $INSTALLER_BIN
  else
    $@
  fi
else
  export DXVK_HUD=full
  export DXVK_CONFIG_FILE=~/dxvk.conf
  wine "${WINEPREFIX}/drive_c/Program Files/Roberts Space Industries/RSI Launcher/RSI Launcher.exe"
fi
